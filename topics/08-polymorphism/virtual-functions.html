<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Virtual Functions - COS110 OOP Study Website</title>
    <link rel="stylesheet" href="../../css/style.css">
</head>
<body>
    <nav class="navbar">
        <a href="../../index.html" class="navbar-brand">üìö COS110 OOP</a>
        <div class="navbar-search"><input type="text" placeholder="Search topics..."></div>
    </nav>

    <div class="container">
        <aside class="sidebar">
            <div class="sidebar-title">üìå Foundations</div>
            <a href="topics/01-pointers/part1.html" class="sidebar-item">Pointers Part 1</a>
            <a href="topics/01-pointers/part2.html" class="sidebar-item">Pointers Part 2</a>

            <div class="sidebar-title">üèóÔ∏è Classes & Objects</div>
            <a href="topics/02-classes/basics.html" class="sidebar-item">Classes Basics</a>
            <a href="topics/02-classes/advanced.html" class="sidebar-item">Classes Advanced</a>
            <a href="topics/02-classes/more.html" class="sidebar-item">Classes More</a>

            <div class="sidebar-title">üîß Constructors</div>
            <a href="topics/03-copy-constructors.html" class="sidebar-item">Copy Constructors</a>
            <a href="topics/04-assignment-operator.html" class="sidebar-item">Assignment Operator</a>

            <div class="sidebar-title">‚ûï Operators</div>
            <a href="topics/05-operator-overloading/basics.html" class="sidebar-item">Overloading Basics</a>
            <a href="topics/05-operator-overloading/friends.html" class="sidebar-item">Friends</a>
            <a href="topics/05-operator-overloading/references.html" class="sidebar-item">References/IO</a>
            <a href="topics/05-operator-overloading/increment.html" class="sidebar-item">Inc/Dec/Subscript</a>

            <div class="sidebar-title">‚ö†Ô∏è Exception Handling</div>
            <a href="topics/06-exception-handling/basics.html" class="sidebar-item">Basics</a>
            <a href="topics/06-exception-handling/hierarchies.html" class="sidebar-item">Hierarchies</a>

            <div class="sidebar-title">üë®‚Äçüëß Inheritance</div>
            <a href="topics/07-inheritance/basics.html" class="sidebar-item">Basics</a>
            <a href="topics/07-inheritance/redefining.html" class="sidebar-item">Redefining</a>
            <a href="topics/07-inheritance/aggregation.html" class="sidebar-item">Aggregation</a>

            <div class="sidebar-title">üîÑ Polymorphism</div>
            <a href="topics/08-polymorphism/virtual-functions.html" class="sidebar-item">Virtual Functions</a>
            <a href="topics/08-polymorphism/pointers.html" class="sidebar-item">Pointers</a>

            <div class="sidebar-title">üé® Templates</div>
            <a href="topics/09-templates/classes.html" class="sidebar-item">Classes</a>
            <a href="topics/09-templates/functions.html" class="sidebar-item">Functions</a>

            <div class="sidebar-title">üìä Data Structures</div>
            <a href="topics/10-data-structures/linked-lists.html" class="sidebar-item">Linked Lists</a>
            <a href="topics/10-data-structures/doubly-linked.html" class="sidebar-item">Doubly Linked</a>
            <a href="topics/10-data-structures/circular-lists.html" class="sidebar-item">Circular Lists</a>
            <a href="topics/10-data-structures/stacks.html" class="sidebar-item">Stacks</a>
            <a href="topics/10-data-structures/queues.html" class="sidebar-item">Queues</a>
            <a href="topics/10-data-structures/stl.html" class="sidebar-item">STL</a>
        </aside>

        <main class="main-content">
            <h1>‚ö° Virtual Functions - Polymorphism</h1>

            <section class="section">
                <div class="section-title">üìö Explanation</div>
                <div class="explanation">
                    <h3 style="color: var(--primary);">Virtual Functions</h3>
                    <p>Virtual functions enable true polymorphism in C++. When a function is declared virtual in the base class, the correct derived version is called based on the actual object type, not the pointer/reference type. This allows dynamic (runtime) dispatch.</p>

                    <h3 style="color: var(--primary); margin-top: 20px;">How Virtual Works</h3>
                    <p>Classes with virtual functions have a virtual table (vtable) that maps function names to implementations. At runtime, the program looks up the correct function in the vtable. This has a small performance cost but enables flexible, extensible code.</p>

                    <h3 style="color: var(--primary); margin-top: 20px;">Pure Virtual Functions</h3>
                    <p>A pure virtual function has no implementation and must be overridden by derived classes. Syntax: virtual void func() = 0;. Classes with pure virtual functions are abstract and cannot be instantiated. They define interfaces that subclasses must implement.</p>

                    <h3 style="color: var(--primary); margin-top: 20px;">Abstract Classes</h3>
                    <p>A class with at least one pure virtual function is abstract. Abstract classes cannot be instantiated but can be used as base classes. They enforce derived classes to implement required methods, ensuring a consistent interface.</p>

                    <h3 style="color: var(--primary); margin-top: 20px;">Override and Final Keywords</h3>
                    <p>Use override to explicitly mark that a method overrides a virtual base method. This helps prevent errors. Use final to prevent further overriding. These keywords document intent and enable compiler checking.</p>
                </div>
            </section>

            <section class="section">
                <div class="section-title">üíª Code Examples</div>

                <div class="code-example">
                    <div class="code-tabs">
                        <button class="code-tab active" data-tab="simple1">Virtual Functions</button>
                        <button class="code-tab" data-tab="full1">Full Program</button>
                    </div>
                    <div data-tab-content="simple1" class="code-editor">
class Shape {
public:
    virtual void draw() {
        cout << "Generic shape" << endl;
    }
    virtual ~Shape() {}
};

class Circle : public Shape {
public:
    void draw() override {
        cout << "Drawing circle" << endl;
    }
};

Shape* s = new Circle();
s->draw();  // Calls Circle::draw()
delete s;
                    </div>
                    <div data-tab-content="full1" style="display: none;">
                        <textarea class="code-editor" id="code1">#include <iostream>
#include <string>
using namespace std;

class Animal {
protected:
    string name;
public:
    Animal(string n) : name(n) {}
    
    virtual void speak() {
        cout << name << " makes sound" << endl;
    }
    
    virtual ~Animal() {
        cout << name << " destroyed" << endl;
    }
};

class Dog : public Animal {
public:
    Dog(string n) : Animal(n) {}
    
    void speak() override {
        cout << name << " barks: Woof!" << endl;
    }
};

class Cat : public Animal {
public:
    Cat(string n) : Animal(n) {}
    
    void speak() override {
        cout << name << " meows: Meow!" << endl;
    }
};

int main() {
    Animal* animals[3];
    animals[0] = new Dog("Rex");
    animals[1] = new Cat("Whiskers");
    animals[2] = new Dog("Buddy");
    
    for(int i = 0; i < 3; i++) {
        animals[i]->speak();
        delete animals[i];
    }
    
    return 0;
}
                        </textarea>
                    </div>
                    <div class="code-buttons">
                        <button class="btn btn-primary" onclick="runCode(document.getElementById('code1'), document.getElementById('output1'))">‚ñ∂ Run Code</button>
                    </div>
                    <div class="output-box" id="output1">Click "Run Code" to execute...</div>
                </div>

                <div class="code-example">
                    <div class="code-tabs">
                        <button class="code-tab active" data-tab="simple2">Pure Virtual - Abstract</button>
                        <button class="code-tab" data-tab="full2">Full Program</button>
                    </div>
                    <div data-tab-content="simple2" class="code-editor">
class Shape {
public:
    virtual void draw() = 0;
    virtual double area() = 0;
    virtual ~Shape() {}
};

// Shape s;  // Error: abstract class

class Circle : public Shape {
    void draw() override { /* ... */ }
    double area() override { /* ... */ }
};

Circle c;  // OK: implements all pure virtuals
                    </div>
                    <div data-tab-content="full2" style="display: none;">
                        <textarea class="code-editor" id="code2">#include <iostream>
#include <cmath>
using namespace std;

class Shape {
public:
    virtual void draw() = 0;
    virtual double area() = 0;
    virtual double perimeter() = 0;
    virtual ~Shape() {}
};

class Rectangle : public Shape {
private:
    double width, height;
public:
    Rectangle(double w, double h) 
        : width(w), height(h) {}
    
    void draw() override {
        cout << "Drawing rectangle" << endl;
    }
    
    double area() override {
        return width * height;
    }
    
    double perimeter() override {
        return 2 * (width + height);
    }
};

class Circle : public Shape {
private:
    double radius;
public:
    Circle(double r) : radius(r) {}
    
    void draw() override {
        cout << "Drawing circle" << endl;
    }
    
    double area() override {
        return 3.14159 * radius * radius;
    }
    
    double perimeter() override {
        return 2 * 3.14159 * radius;
    }
};

int main() {
    Rectangle r(5, 3);
    Circle c(4);
    
    r.draw();
    cout << "Area: " << r.area() 
         << ", Perimeter: " << r.perimeter() << endl;
    
    c.draw();
    cout << "Area: " << c.area() 
         << ", Perimeter: " << c.perimeter() << endl;
    
    return 0;
}
                        </textarea>
                    </div>
                    <div class="code-buttons">
                        <button class="btn btn-primary" onclick="runCode(document.getElementById('code2'), document.getElementById('output2'))">‚ñ∂ Run Code</button>
                    </div>
                    <div class="output-box" id="output2">Click "Run Code" to execute...</div>
                </div>

                <div class="code-example">
                    <div class="code-tabs">
                        <button class="code-tab active" data-tab="simple3">Polymorphic Containers</button>
                        <button class="code-tab" data-tab="full3">Full Program</button>
                    </div>
                    <div data-tab-content="simple3" class="code-editor">
vector<Shape*> shapes;
shapes.push_back(new Circle());
shapes.push_back(new Rectangle());
shapes.push_back(new Triangle());

for(auto shape : shapes) {
    shape->draw();
    cout << "Area: " << shape->area() << endl;
    delete shape;
}
                    </div>
                    <div data-tab-content="full3" style="display: none;">
                        <textarea class="code-editor" id="code3">#include <iostream>
#include <vector>
#include <cmath>
using namespace std;

class Shape {
public:
    virtual void draw() = 0;
    virtual double area() = 0;
    virtual ~Shape() {}
};

class Circle : public Shape {
private:
    double radius;
public:
    Circle(double r) : radius(r) {}
    void draw() override { 
        cout << "Circle"; 
    }
    double area() override { 
        return 3.14159 * radius * radius; 
    }
};

class Rectangle : public Shape {
private:
    double w, h;
public:
    Rectangle(double w, double h) 
        : w(w), h(h) {}
    void draw() override { 
        cout << "Rectangle"; 
    }
    double area() override { 
        return w * h; 
    }
};

class Triangle : public Shape {
private:
    double base, height;
public:
    Triangle(double b, double h) 
        : base(b), height(h) {}
    void draw() override { 
        cout << "Triangle"; 
    }
    double area() override { 
        return 0.5 * base * height; 
    }
};

int main() {
    vector<Shape*> shapes;
    shapes.push_back(new Circle(5));
    shapes.push_back(new Rectangle(4, 3));
    shapes.push_back(new Triangle(6, 4));
    
    double totalArea = 0;
    for(auto shape : shapes) {
        shape->draw();
        double a = shape->area();
        cout << " - Area: " << a << endl;
        totalArea += a;
    }
    
    cout << "Total area: " << totalArea << endl;
    
    for(auto shape : shapes) {
        delete shape;
    }
    
    return 0;
}
                        </textarea>
                    </div>
                    <div class="code-buttons">
                        <button class="btn btn-primary" onclick="runCode(document.getElementById('code3'), document.getElementById('output3'))">‚ñ∂ Run Code</button>
                    </div>
                    <div class="output-box" id="output3">Click "Run Code" to execute...</div>
                </div>
            </section>

            <section class="section">
                <div class="section-title">‚úçÔ∏è Coding Activities</div>

                <div class="activity">
                    <div class="activity-title">‚ö° Intermediate Challenge: Vehicle Polymorphism</div>
                    <p>Create abstract Vehicle with concrete Car, Motorcycle, Truck derived classes.</p>
                    <button class="btn btn-secondary" onclick="downloadCode(\`#include <iostream>
using namespace std;

class Vehicle {
public:
    virtual void start() = 0;
    virtual void stop() = 0;
    virtual int getMaxSpeed() = 0;
    virtual ~Vehicle() {}
};

// TODO: Car, Motorcycle, Truck classes

int main() {
    Vehicle* v1 = new Car();
    Vehicle* v2 = new Motorcycle();
    
    v1->start();
    cout << \"Max: \" << v1->getMaxSpeed() << endl;
    v1->stop();
    
    delete v1;
    delete v2;
    return 0;
}\`, 'vehicle_polymorphism.cpp')">‚¨á Download Skeleton</button>
                    <button class="collapsible">‚ñº Show Solution</button>
                    <div class="collapsible-content">
                        <div class="code-editor">
#include <iostream>
using namespace std;

class Vehicle {
protected:
    string name;
public:
    Vehicle(string n) : name(n) {}
    virtual void start() = 0;
    virtual void stop() = 0;
    virtual int getMaxSpeed() = 0;
    virtual ~Vehicle() {}
};

class Car : public Vehicle {
public:
    Car() : Vehicle("Car") {}
    void start() override { 
        cout << name << " engine starts" << endl; 
    }
    void stop() override { 
        cout << name << " stops" << endl; 
    }
    int getMaxSpeed() override { return 180; }
};

class Motorcycle : public Vehicle {
public:
    Motorcycle() : Vehicle("Motorcycle") {}
    void start() override { 
        cout << name << " engine roars" << endl; 
    }
    void stop() override { 
        cout << name << " stops" << endl; 
    }
    int getMaxSpeed() override { return 200; }
};

class Truck : public Vehicle {
public:
    Truck() : Vehicle("Truck") {}
    void start() override { 
        cout << name << " diesel starts" << endl; 
    }
    void stop() override { 
        cout << name << " stops" << endl; 
    }
    int getMaxSpeed() override { return 120; }
};

int main() {
    Car c;
    Motorcycle m;
    Truck t;
    
    Vehicle* vehicles[] = {&c, &m, &t};
    
    for(auto v : vehicles) {
        v->start();
        cout << "Max speed: " << v->getMaxSpeed() 
             << " km/h" << endl;
        v->stop();
        cout << endl;
    }
    
    return 0;
}
                        </div>
                    </div>
                </div>

                <div class="activity">
                    <div class="activity-title">üî• Advanced Challenge: Game Entity System</div>
                    <p>Create abstract Entity with Player, Enemy, Item derived classes and polymorphic update/render.</p>
                    <button class="btn btn-secondary" onclick="downloadCode(\`#include <iostream>
#include <vector>
using namespace std;

class Entity {
protected:
    int x, y;
    string type;
public:
    Entity(int px, int py, string t) 
        : x(px), y(py), type(t) {}
    
    virtual void update() = 0;
    virtual void render() = 0;
    virtual ~Entity() {}
};

// TODO: Player class (update position, render player)
// TODO: Enemy class (AI movement, render enemy)
// TODO: Item class (collision detection, render item)

int main() {
    vector<Entity*> entities;
    entities.push_back(new Player(0, 0));
    entities.push_back(new Enemy(10, 10));
    entities.push_back(new Item(5, 5));
    
    for(auto e : entities) {
        e->update();
        e->render();
    }
    
    for(auto e : entities) delete e;
    return 0;
}\`, 'game_entities.cpp')">‚¨á Download Skeleton</button>
                    <button class="collapsible">‚ñº Show Solution</button>
                    <div class="collapsible-content">
                        <div class="code-editor">
#include <iostream>
#include <vector>
using namespace std;

class Entity {
protected:
    int x, y;
    string type;
public:
    Entity(int px, int py, string t) 
        : x(px), y(py), type(t) {}
    
    virtual void update() = 0;
    virtual void render() = 0;
    virtual ~Entity() {}
};

class Player : public Entity {
private:
    int health;
public:
    Player(int x, int y) 
        : Entity(x, y, "Player"), health(100) {}
    
    void update() override {
        cout << "Player update" << endl;
    }
    
    void render() override {
        cout << "Player @ (" << x << "," << y 
             << ") HP:" << health << endl;
    }
};

class Enemy : public Entity {
private:
    int damage;
public:
    Enemy(int x, int y) 
        : Entity(x, y, "Enemy"), damage(10) {}
    
    void update() override {
        x += 1;
        cout << "Enemy moving..." << endl;
    }
    
    void render() override {
        cout << "Enemy @ (" << x << "," << y 
             << ") DMG:" << damage << endl;
    }
};

class Item : public Entity {
private:
    int value;
public:
    Item(int x, int y) 
        : Entity(x, y, "Item"), value(50) {}
    
    void update() override {
        cout << "Item idle" << endl;
    }
    
    void render() override {
        cout << "Item @ (" << x << "," << y 
             << ") Value:" << value << endl;
    }
};

int main() {
    vector<Entity*> entities;
    entities.push_back(new Player(0, 0));
    entities.push_back(new Enemy(10, 10));
    entities.push_back(new Item(5, 5));
    
    cout << "=== Update ===" << endl;
    for(auto e : entities) {
        e->update();
    }
    
    cout << "\n=== Render ===" << endl;
    for(auto e : entities) {
        e->render();
    }
    
    for(auto e : entities) delete e;
    return 0;
}
                        </div>
                    </div>
                </div>
            </section>

            <section class="section">
                <div class="section-title">üìù Knowledge Check Quiz</div>
                <div class="quiz-container">
                    <button class="quiz-btn" onclick="initializeQuiz()">‚ñ∂ Start Quiz</button>
                </div>
            </section>
        </main>
    </div>

    <footer><p>COS110 OOP Study Website | November 2025</p></footer>

    <script src="../../js/main.js"></script>
    <script src="../../js/compiler.js"></script>
    <script src="../../js/quiz.js"></script>

    <script>
        function initializeQuiz() {
            const questions = [
                {type: 'multiple-choice', question: 'Virtual functions enable:', options: ['Static dispatch', 'Dynamic dispatch', 'Compilation', 'None'], correctAnswer: 'B', explanation: 'Virtual functions allow runtime dispatch based on object type.'},
                {type: 'true-false', question: 'Virtual functions require inheritance.', correctAnswer: 'true', explanation: 'Yes, virtual is only useful with polymorphism through inheritance.'},
                {type: 'multiple-choice', question: 'Virtual table (vtable) is:', options: ['Created by programmer', 'Compiler generated', 'Fixed at compile time', 'Optional'], correctAnswer: 'B', explanation: 'Compiler generates vtable for classes with virtual functions.'},
                {type: 'fill-in', question: 'Pure virtual function:', context: 'virtual void func() <span style="color: red;">_______</span>;', hint: '= 0', acceptableAnswers: ['= 0', '=0'], explanation: 'Pure virtual has no implementation, declared with = 0.'},
                {type: 'true-false', question: 'Abstract class can be instantiated.', correctAnswer: 'false', explanation: 'No, classes with pure virtual functions are abstract.'},
                {type: 'multiple-choice', question: 'Abstract class is used for:', options: ['Templates', 'Interfaces', 'Base classes', 'B and C'], correctAnswer: 'D', explanation: 'Abstract classes define interfaces and serve as base classes.'},
                {type: 'true-false', question: 'Derived class must override pure virtual.', correctAnswer: 'true', explanation: 'Yes, otherwise derived is also abstract.'},
                {type: 'multiple-choice', question: 'Override keyword is:', options: ['Required', 'Recommended', 'For documentation', 'B and C'], correctAnswer: 'D', explanation: 'Override documents intent and enables compiler checking.'},
                {type: 'true-false', question: 'Final keyword prevents further overriding.', correctAnswer: 'true', explanation: 'Yes, final stops the method from being overridden.'},
                {type: 'fill-in', question: 'Override syntax:', context: 'void func() <span style="color: red;">_______</span>;', hint: 'keyword', acceptableAnswers: ['override', 'override '], explanation: 'Use override keyword to mark base method override.'},
                {type: 'multiple-choice', question: 'Base destructor should be:', options: ['Public', 'Virtual', 'Protected', 'B and C'], correctAnswer: 'D', explanation: 'Base destructors should be virtual or protected.'},
                {type: 'true-false', question: 'Polymorphism requires pointers/references.', correctAnswer: 'true', explanation: 'Yes, need indirection for dynamic dispatch.'},
                {type: 'multiple-choice', question: 'Virtual function overhead:', options: ['None', 'Small', 'Significant', 'Depends'], correctAnswer: 'B', explanation: 'Virtual has small performance cost due to vtable lookup.'},
                {type: 'true-false', question: 'Can create vector of base pointers.', correctAnswer: 'true', explanation: 'Yes, vector<Base*> can hold any derived type.'},
                {type: 'multiple-choice', question: 'Pure virtual declares:', options: ['Contract', 'Implementation', 'Optional', 'All'], correctAnswer: 'A', explanation: 'Pure virtual declares required interface contract.'},
                {type: 'true-false', question: 'Virtual applies to constructors.', correctAnswer: 'false', explanation: 'Constructors cannot be virtual.'},
                {type: 'multiple-choice', question: 'Calling virtual through:', options: ['Object', 'Pointer', 'Reference', 'B and C'], correctAnswer: 'D', explanation: 'Virtual dispatch requires pointer or reference.'},
                {type: 'fill-in', question: 'Static cast vs dynamic dispatch:', context: 'Virtual functions use <span style="color: red;">_______</span> dispatch', hint: 'dynamic', acceptableAnswers: ['dynamic', 'dynamic '], explanation: 'Virtual functions use dynamic (runtime) dispatch.'},
                {type: 'true-false', question: 'Derived must implement all pure virtuals.', correctAnswer: 'true', explanation: 'Yes, otherwise derived is also abstract.'},
                {type: 'multiple-choice', question: 'Best practice for polymorphism:', options: ['Use virtual', 'Document with override', 'Virtual destructor', 'All above'], correctAnswer: 'D', explanation: 'All are important for proper polymorphism.'}
            ];

            window.quizSystem = new QuizSystem('Virtual Functions', questions);
            openQuizModal();
        }

        if (!document.getElementById('quizModal')) {
            const modal = document.createElement('div');
            modal.id = 'quizModal';
            modal.className = 'quiz-modal';
            modal.innerHTML = `<div class="quiz-modal-content"><div class="quiz-header"><div><div class="quiz-question-number">Quiz: Virtual Functions</div><div class="quiz-progress">Question 1 of 20</div></div><button class="quiz-close" onclick="closeQuizModal()">‚úï</button></div><div class="quiz-questions-container"></div></div>`;
            document.body.appendChild(modal);
        }
    </script>
</body>
</html>